clean:
	rm -f obj/*.o
	rm -f bin/testRead
	rmdir obj/
	rmdir bin/

makedirectories:
	mkdir obj
	mkdir bin

ifeq ($(USE_MPI), 1)
CXX                 :=  mpiCC
else
CXX                 :=  g++
endif

# link all objects to the executable
link: makedirectories
	$(CXX) -O3  -Wall -c src/CReadData.cpp -o obj/CReadData.o
	$(CXX) -O3  -Wall -c src/main.cpp -o obj/main.o -DMKL_ILP64 -I${MKLROOT}/include ${MKLROOT}/lib/intel64/libmkl_scalapack_ilp64.a -Wl,--start-group ${MKLROOT}/lib/intel64/libmkl_intel_ilp64.a ${MKLROOT}/lib/intel64/libmkl_core.a ${MKLROOT}/lib/intel64/libmkl_sequential.a ${MKLROOT}/lib/intel64/libmkl_blacs_intelmpi_ilp64.a -Wl,--end-group -lpthread -lm


all: link
	$(CXX) obj/CReadData.o obj/main.o -o bin/testRead -DMKL_ILP64 -I${MKLROOT}/include ${MKLROOT}/lib/intel64/libmkl_scalapack_ilp64.a -Wl,--start-group ${MKLROOT}/lib/intel64/libmkl_intel_ilp64.a ${MKLROOT}/lib/intel64/libmkl_core.a ${MKLROOT}/lib/intel64/libmkl_sequential.a ${MKLROOT}/lib/intel64/libmkl_blacs_intelmpi_ilp64.a -Wl,--end-group -lpthread -lm
